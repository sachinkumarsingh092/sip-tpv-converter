

xdiff
ydiff



=cd

′



udiff
vdiff



crval1′=crval1+xdiff/cos(crval2*π/180)
crval2′=crval2+ydiff
definetheintermediatepolynomialsk[i][j]andl[i][j]asfollows:
2
2
*pv1[6]
k[0][2]=cd[1][2]
*pv1[4]+cd[1][2]*cd[2][2]*pv1[5]+cd[2][2]
2
2
*pv2[4]
l[0][2]=cd[1][2]
*pv2[6]+cd[1][2]*cd[2][2]*pv2[5]+cd[2][2]
k[1][1]=2*cd[1][1]*cd[1][2]*pv1[4]+cd[1][1]*cd[2][2]*pv1[5]+cd[1][2]*cd[2][1]*pv1[5]
+2*cd[2][1]*cd[2][2]*pv1[6]

l[1][1]=2*cd[1][1]*cd[1][2]*pv2[6]+cd[1][1]*cd[2][2]*pv2[5]+cd[1][2]*cd[2][1]*pv2[5]
+2*cd[2][1]*cd[2][2]*pv2[4]
2
2
*pv1[6]
k[0][2]=cd[1][2]
*pv1[4]+cd[1][2]*cd[2][2]*pv1[5]+cd[2][2]
2
2
l[0][2]=cd[1][2]
*pv2[6]+cd[1][2]*cd[2][2]*pv2[5]+cd[2][2]
*pv2[4]
3
2
2
3
k[0][3]=cd[1][2]
*pv1[7]+cd[1][2]
*cd[2][2]*pv1[8]+cd[1][2]*cd[2][2]
*pv1[9]+cd[2][2]
*pv1[1]0
3
2
2
3
l[0][3]=cd[1][2]
*pv2[1]0+cd[1][2]
*cd[2][2]*pv2[9]+cd[1][2]*cd[2][2]
*pv2[8]+cd[2][2]
*pv2[7]
2
2
k[1][2]=3*cd[1][1]*cd[1][2]
*pv1[7]+2*cd[1][1]*cd[1][2]*cd[2][2]*pv1[8]+cd[1][1]*cd[2][2]
*pv1[9]
2
2
*pv1[1]0
+cd[1][2]
*cd[2][1]*pv1[8]+2*cd[1][2]*cd[2][1]*cd[2][2]*pv1[9]+3*cd[2][1]*cd[2][2]
2
2
l[1][2]=3*cd[1][1]*cd[1][2]
*pv2[1]0+2*cd[1][1]*cd[1][2]*cd[2][2]*pv2[9]+cd[1][1]*cd[2][2]
*pv2[8]
2
2
+cd[1][2]
*cd[2][1]*pv2[9]+2*cd[1][2]*cd[2][1]*cd[2][2]*pv2[8]+3*cd[2][1]*cd[2][2]
*pv2[7]
2
2
*cd[2][2]*pv1[8]+2*cd[1][1]*cd[1][2]*cd[2][1]*pv1[8]
k[2][1]=3*cd[1][1]
*cd[1][2]*pv1[7]+cd[1][1]
2
2
+2*cd[1][1]*cd[2][1]*cd[2][2]*pv1[9]+cd[1][2]*cd[2][1]
*pv1[9]+3*cd[2][1]
*cd[2][2]*pv1[1]0
2
2
l[2][1]=3*cd[1][1]
*cd[1][2]*pv2[1]0+cd[1][1]
*cd[2][2]*pv2[9]+2*cd[1][1]*cd[1][2]*cd[2][1]*pv2[9]
2
2
+2*cd[1][1]*cd[2][1]*cd[2][2]*pv2[8]+cd[1][2]*cd[2][1]
*pv2[8]+3*cd[2][1]
*cd[2][2]*pv2[7]
3
2
2
3
k[3][0]=cd[1][1]
*pv1[7]+cd[1][1]
*cd[2][1]*pv1[8]+cd[1][1]*cd[2][1]
*pv1[9]+cd[2][1]
*pv1[1]0
3
2
2
3
l[3][0]=cd[1][1]
*pv2[1]0+cd[1][1]
*cd[2][1]*pv2[9]+cd[1][1]*cd[2][1]
*pv2[8]+cd[2][1]
*pv2[7]
4
3
2
2
k[0][4]=cd[1][2]
*pv1[1]2+cd[1][2]
*cd[2][2]*pv1[1]3+cd[1][2]
*cd[2][2]
*pv1[1]4
4
3
+cd[1][2]*cd[2][2]
*pv1[1]5+cd[2][2]
*pv1[1]6
4
3
2
2
l[0][4]=cd[1][2]
*pv2[1]6+cd[1][2]
*cd[2][2]*pv2[1]5+cd[1][2]
*cd[2][2]
*pv2[1]4
3
4
+cd[1][2]*cd[2][2]
*pv2[1]3+cd[2][2]
*pv2[1]2
2
2
3
k[1][3]=4*cd[1][1]*cd[1][2]
*pv1[1]2+3*cd[1][1]*cd[1][2]
*cd[2][2]*pv1[1]3+2*cd[1][1]*cd[1][2]*cd[2][2]
*pv1[1]4
3
3
2
+cd[1][1]*cd[2][2]
*pv1[1]5+cd[1][2]
*cd[2][1]*pv1[1]3+2*cd[1][2]
*cd[2][1]*cd[2][2]*pv1[1]4
2
3
+3*cd[1][2]*cd[2][1]*cd[2][2]
*pv1[1]5+4*cd[2][1]*cd[2][2]
*pv1[1]6
3
2
2
l[1][3]=4*cd[1][1]*cd[1][2]
*pv2[1]6+3*cd[1][1]*cd[1][2]
*cd[2][2]*pv2[1]5+2*cd[1][1]*cd[1][2]*cd[2][2]
*pv2[1]4
3
2
3
+cd[1][1]*cd[2][2]
*pv2[1]3+cd[1][2]
*cd[2][1]*pv2[1]5+2*cd[1][2]
*cd[2][1]*cd[2][2]*pv2[1]4
2
3
+3*cd[1][2]*cd[2][1]*cd[2][2]
*pv2[1]3+4*cd[2][1]*cd[2][2]
*pv2[1]2
2
2
2
2
2
k[2][2]=6*cd[1][1]
*cd[1][2]
*pv1[1]2+3*cd[1][1]
*cd[1][2]*cd[2][2]*pv1[1]3+cd[1][1]
*cd[2][2]
*pv1[1]4
2
+3*cd[1][1]*cd[1][2]
*cd[2][1]*pv1[1]3+4*cd[1][1]*cd[1][2]*cd[2][1]*cd[2][2]*pv1[1]4

proc.ofspievol.845184511m-9
downloadedfrom:http://proceedings.spiedigitallibrary.org/on02/22/2013termsofuse:http://spiedl.org/terms

2
2
2
+3*cd[1][1]*cd[2][1]*cd[2][2]
*pv1[1]5+cd[1][2]
*cd[2][1]
*pv1[1]4
2
2
2
+3*cd[1][2]*cd[2][1]
*cd[2][2]*pv1[1]5+6*cd[2][1]
*cd[2][2]
*pv1[1]6
2
2
2
2
2
*cd[1][2]*cd[2][2]*pv2[1]5+cd[1][1]
*cd[2][2]
*pv2[1]4
l[2][2]=6*cd[1][1]
*cd[1][2]
*pv2[1]6+3*cd[1][1]
2
+3*cd[1][1]*cd[1][2]
*cd[2][1]*pv2[1]5+4*cd[1][1]*cd[1][2]*cd[2][1]*cd[2][2]*pv2[1]4+
2
2
2
3*cd[1][1]*cd[2][1]*cd[2][2]
*pv2[1]3+cd[1][2]
*cd[2][1]
*pv2[1]4
2
2
2
+3*cd[1][2]*cd[2][1]
*cd[2][2]*pv2[1]3+6*cd[2][1]
*cd[2][2]
*pv2[1]2
3
3
2
k[3][1]=4*cd[1][1]
*cd[1][2]*pv1[1]2+cd[1][1]
*cd[2][2]*pv1[1]3+3*cd[1][1]
*cd[1][2]*cd[2][1]*pv1[1]3
2
2
*pv1[1]4
+2*cd[1][1]
*cd[2][1]*cd[2][2]*pv1[1]4+2*cd[1][1]*cd[1][2]*cd[2][1]
2
3
3
+3*cd[1][1]*cd[2][1]
*cd[2][2]*pv1[1]5+cd[1][2]*cd[2][1]
*pv1[1]5+4*cd[2][1]
*cd[2][2]*pv1[1]6
3
3
2
l[3][1]=4*cd[1][1]
*cd[1][2]*pv2[1]6+cd[1][1]
*cd[2][2]*pv2[1]5+3*cd[1][1]
*cd[1][2]*cd[2][1]*pv2[1]5
2
2
*pv2[1]4
+2*cd[1][1]
*cd[2][1]*cd[2][2]*pv2[1]4+2*cd[1][1]*cd[1][2]*cd[2][1]
2
3
3
+3*cd[1][1]*cd[2][1]
*cd[2][2]*pv2[1]3+cd[1][2]*cd[2][1]
*pv2[1]3+4*cd[2][1]
*cd[2][2]*pv2[1]2
3
2
2
4
*cd[2][1]*pv1[1]3+cd[1][1]
*cd[2][1]
*pv1[1]4
k[4][0]=cd[1][1]
*pv1[1]2+cd[1][1]
3
4
+cd[1][1]*cd[2][1]
*pv1[1]5+cd[2][1]
*pv1[1]6
4
3
2
2
l[4][0]=cd[1][1]
*pv2[1]6+cd[1][1]
*cd[2][1]*pv2[1]5+cd[1][1]
*cd[2][1]
*pv2[1]4
4
3
*pv2[1]2
+cd[1][1]*cd[2][1]
*pv2[1]3+cd[2][1]

notethatmuchofthecomplicationintheseequationsiscausedbythearbitraryindicesassignedtothepv
coefficients.thenextstepistocomputetheinverseofthecd[′][m]atrixascd[′][−]1.then,thesipcoefficients
arecomputedasfollows:


ai,j
bi,j



=cd[′][−]1



k[i][j]
l[i][j]



.

thereverse-sipcoefficientsarecalculatedandthepvc[o]efficientsarerecalculatedbyoursoftware,butthese
equationsarenotshownhere.

appendixb.samplefitsheader
forasampleptfimage(withprocessed-imageid=13051948),belowisalistingoftheportionofitsfits
headerthatisrelevanttothewcssolutionandthetworepresentationsofgeometricd[i][s]tortioncontainedtherein.
see§4foradiscussionofthisexample.noticethemissingscamp-generatedpvi[j]keywordsthatcorrespond
totheradialtermsineqs.1and2.
/astrometry
crval1
crval2
crpix1
crpix2
ctype1
ctype2
cunit1
cunit2
crtype1
crtype2
cd[1][_]1

=
=
=
=
=
=
=
=
=
=
=

104.758177886399
17.5110457095458
767.6599731
1732.279053
’ra---tan-sip’
’dec--tan-sip’
’deg
’
’deg
’
’deg
’
’deg
’
0.000281189660249318

/[deg]raofreferencepoint
/[deg]decofreferencepoint

/
/
/
/
/
/
/

tan(gnomic)projection+sipdistortions
tan(gnomic)projection+sipdistortions
imageaxis-1celestial-coordinateunits
imageaxis-2celestial-coordinateunits
dataunitsofcrval1
dataunitsofcrval2
transformationmatrix

proc.ofspievol.845184511m-10
downloadedfrom:http://proceedings.spiedigitallibrary.org/on02/22/2013termsofuse:http://spiedl.org/terms



xdiff
ydiff



=cd

′



udiff
vdiff



crval1′=crval1+xdiff/cos(crval2*π/180)
crval2′=crval2+ydiff
definetheintermediatepolynomialsk[i][j]andl[i][j]asfollows:
2
2
*pv1[[]6]
k[0][2]=cd[[][1]][2]
*pv1[[]4]+cd[[][1]][2]*cd[[][2]][2]*pv1[[]5]+cd[[][2]][2]
2
2
*pv2[[]4]
l[0][2]=cd[[][1]][2]
*pv2[[]6]+cd[[][1]][2]*cd[[][2]][2]*pv2[[]5]+cd[[][2]][2]
k[1][1]=2*cd[[][1]][1]*cd[[][1]][2]*pv1[[]4]+cd[[][1]][1]*cd[[][2]][2]*pv1[[]5]+cd[[][1]][2]*cd[[][2]][1]*pv1[[]5]
+2*cd[[][2]][1]*cd[[][2]][2]*pv1[[]6]

l[1][1]=2*cd[[][1]][1]*cd[[][1]][2]*pv2[[]6]+cd[[][1]][1]*cd[[][2]][2]*pv2[[]5]+cd[[][1]][2]*cd[[][2]][1]*pv2[[]5]
+2*cd[[][2]][1]*cd[[][2]][2]*pv2[[]4]
2
2
*pv1[[]6]
k[0][2]=cd[[][1]][2]
*pv1[[]4]+cd[[][1]][2]*cd[[][2]][2]*pv1[[]5]+cd[[][2]][2]
2
2
l[0][2]=cd[[][1]][2]
*pv2[[]6]+cd[[][1]][2]*cd[[][2]][2]*pv2[[]5]+cd[[][2]][2]
*pv2[[]4]
3
2
2
3
k[0][3]=cd[[][1]][2]
*pv1[[]7]+cd[[][1]][2]
*cd[[][2]][2]*pv1[[]8]+cd[[][1]][2]*cd[[][2]][2]
*pv1[[]9]+cd[[][2]][2]
*pv1[[]1]0
3
2
2
3
l[0][3]=cd[[][1]][2]
*pv2[[]1]0+cd[[][1]][2]
*cd[[][2]][2]*pv2[[]9]+cd[[][1]][2]*cd[[][2]][2]
*pv2[[]8]+cd[[][2]][2]
*pv2[[]7]
2
2
k[1][2]=3*cd[[][1]][1]*cd[[][1]][2]
*pv1[[]7]+2*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][2]*pv1[[]8]+cd[[][1]][1]*cd[[][2]][2]
*pv1[[]9]
2
2
*pv1[[]1]0
+cd[[][1]][2]
*cd[[][2]][1]*pv1[[]8]+2*cd[[][1]][2]*cd[[][2]][1]*cd[[][2]][2]*pv1[[]9]+3*cd[[][2]][1]*cd[[][2]][2]
2
2
l[1][2]=3*cd[[][1]][1]*cd[[][1]][2]
*pv2[[]1]0+2*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][2]*pv2[[]9]+cd[[][1]][1]*cd[[][2]][2]
*pv2[[]8]
2
2
+cd[[][1]][2]
*cd[[][2]][1]*pv2[[]9]+2*cd[[][1]][2]*cd[[][2]][1]*cd[[][2]][2]*pv2[[]8]+3*cd[[][2]][1]*cd[[][2]][2]
*pv2[[]7]
2
2
*cd[[][2]][2]*pv1[[]8]+2*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][1]*pv1[[]8]
k[2][1]=3*cd[[][1]][1]
*cd[[][1]][2]*pv1[[]7]+cd[[][1]][1]
2
2
+2*cd[[][1]][1]*cd[[][2]][1]*cd[[][2]][2]*pv1[[]9]+cd[[][1]][2]*cd[[][2]][1]
*pv1[[]9]+3*cd[[][2]][1]
*cd[[][2]][2]*pv1[[]1]0
2
2
l[2][1]=3*cd[[][1]][1]
*cd[[][1]][2]*pv2[[]1]0+cd[[][1]][1]
*cd[[][2]][2]*pv2[[]9]+2*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][1]*pv2[[]9]
2
2
+2*cd[[][1]][1]*cd[[][2]][1]*cd[[][2]][2]*pv2[[]8]+cd[[][1]][2]*cd[[][2]][1]
*pv2[[]8]+3*cd[[][2]][1]
*cd[[][2]][2]*pv2[[]7]
3
2
2
3
k[3][0]=cd[[][1]][1]
*pv1[[]7]+cd[[][1]][1]
*cd[[][2]][1]*pv1[[]8]+cd[[][1]][1]*cd[[][2]][1]
*pv1[[]9]+cd[[][2]][1]
*pv1[[]1]0
3
2
2
3
l[3][0]=cd[[][1]][1]
*pv2[[]1]0+cd[[][1]][1]
*cd[[][2]][1]*pv2[[]9]+cd[[][1]][1]*cd[[][2]][1]
*pv2[[]8]+cd[[][2]][1]
*pv2[[]7]
4
3
2
2
k[0][4]=cd[[][1]][2]
*pv1[[]1]2+cd[[][1]][2]
*cd[[][2]][2]*pv1[[]1]3+cd[[][1]][2]
*cd[[][2]][2]
*pv1[[]1]4
4
3
+cd[[][1]][2]*cd[[][2]][2]
*pv1[[]1]5+cd[[][2]][2]
*pv1[[]1]6
4
3
2
2
l[0][4]=cd[[][1]][2]
*pv2[[]1]6+cd[[][1]][2]
*cd[[][2]][2]*pv2[[]1]5+cd[[][1]][2]
*cd[[][2]][2]
*pv2[[]1]4
3
4
+cd[[][1]][2]*cd[[][2]][2]
*pv2[[]1]3+cd[[][2]][2]
*pv2[[]1]2
2
2
3
k[1][3]=4*cd[[][1]][1]*cd[[][1]][2]
*pv1[[]1]2+3*cd[[][1]][1]*cd[[][1]][2]
*cd[[][2]][2]*pv1[[]1]3+2*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][2]
*pv1[[]1]4
3
3
2
+cd[[][1]][1]*cd[[][2]][2]
*pv1[[]1]5+cd[[][1]][2]
*cd[[][2]][1]*pv1[[]1]3+2*cd[[][1]][2]
*cd[[][2]][1]*cd[[][2]][2]*pv1[[]1]4
2
3
+3*cd[[][1]][2]*cd[[][2]][1]*cd[[][2]][2]
*pv1[[]1]5+4*cd[[][2]][1]*cd[[][2]][2]
*pv1[[]1]6
3
2
2
l[1][3]=4*cd[[][1]][1]*cd[[][1]][2]
*pv2[[]1]6+3*cd[[][1]][1]*cd[[][1]][2]
*cd[[][2]][2]*pv2[[]1]5+2*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][2]
*pv2[[]1]4
3
2
3
+cd[[][1]][1]*cd[[][2]][2]
*pv2[[]1]3+cd[[][1]][2]
*cd[[][2]][1]*pv2[[]1]5+2*cd[[][1]][2]
*cd[[][2]][1]*cd[[][2]][2]*pv2[[]1]4
2
3
+3*cd[[][1]][2]*cd[[][2]][1]*cd[[][2]][2]
*pv2[[]1]3+4*cd[[][2]][1]*cd[[][2]][2]
*pv2[[]1]2
2
2
2
2
2
k[2][2]=6*cd[[][1]][1]
*cd[[][1]][2]
*pv1[[]1]2+3*cd[[][1]][1]
*cd[[][1]][2]*cd[[][2]][2]*pv1[[]1]3+cd[[][1]][1]
*cd[[][2]][2]
*pv1[[]1]4
2
+3*cd[[][1]][1]*cd[[][1]][2]
*cd[[][2]][1]*pv1[[]1]3+4*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][1]*cd[[][2]][2]*pv1[[]1]4

proc.ofspievol.845184511m-9
downloadedfrom:http://proceedings.spiedigitallibrary.org/on02/22/2013termsofuse:http://spiedl.org/terms

2
2
2
+3*cd[[][1]][1]*cd[[][2]][1]*cd[[][2]][2]
*pv1[[]1]5+cd[[][1]][2]
*cd[[][2]][1]
*pv1[[]1]4
2
2
2
+3*cd[[][1]][2]*cd[[][2]][1]
*cd[[][2]][2]*pv1[[]1]5+6*cd[[][2]][1]
*cd[[][2]][2]
*pv1[[]1]6
2
2
2
2
2
*cd[[][1]][2]*cd[[][2]][2]*pv2[[]1]5+cd[[][1]][1]
*cd[[][2]][2]
*pv2[[]1]4
l[2][2]=6*cd[[][1]][1]
*cd[[][1]][2]
*pv2[[]1]6+3*cd[[][1]][1]
2
+3*cd[[][1]][1]*cd[[][1]][2]
*cd[[][2]][1]*pv2[[]1]5+4*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][1]*cd[[][2]][2]*pv2[[]1]4+
2
2
2
3*cd[[][1]][1]*cd[[][2]][1]*cd[[][2]][2]
*pv2[[]1]3+cd[[][1]][2]
*cd[[][2]][1]
*pv2[[]1]4
2
2
2
+3*cd[[][1]][2]*cd[[][2]][1]
*cd[[][2]][2]*pv2[[]1]3+6*cd[[][2]][1]
*cd[[][2]][2]
*pv2[[]1]2
3
3
2
k[3][1]=4*cd[[][1]][1]
*cd[[][1]][2]*pv1[[]1]2+cd[[][1]][1]
*cd[[][2]][2]*pv1[[]1]3+3*cd[[][1]][1]
*cd[[][1]][2]*cd[[][2]][1]*pv1[[]1]3
2
2
*pv1[[]1]4
+2*cd[[][1]][1]
*cd[[][2]][1]*cd[[][2]][2]*pv1[[]1]4+2*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][1]
2
3
3
+3*cd[[][1]][1]*cd[[][2]][1]
*cd[[][2]][2]*pv1[[]1]5+cd[[][1]][2]*cd[[][2]][1]
*pv1[[]1]5+4*cd[[][2]][1]
*cd[[][2]][2]*pv1[[]1]6
3
3
2
l[3][1]=4*cd[[][1]][1]
*cd[[][1]][2]*pv2[[]1]6+cd[[][1]][1]
*cd[[][2]][2]*pv2[[]1]5+3*cd[[][1]][1]
*cd[[][1]][2]*cd[[][2]][1]*pv2[[]1]5
2
2
*pv2[[]1]4
+2*cd[[][1]][1]
*cd[[][2]][1]*cd[[][2]][2]*pv2[[]1]4+2*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][1]
2
3
3
+3*cd[[][1]][1]*cd[[][2]][1]
*cd[[][2]][2]*pv2[[]1]3+cd[[][1]][2]*cd[[][2]][1]
*pv2[[]1]3+4*cd[[][2]][1]
*cd[[][2]][2]*pv2[[]1]2
3
2
2
4
*cd[[][2]][1]*pv1[[]1]3+cd[[][1]][1]
*cd[[][2]][1]
*pv1[[]1]4
k[4][0]=cd[[][1]][1]
*pv1[[]1]2+cd[[][1]][1]
3
4
+cd[[][1]][1]*cd[[][2]][1]
*pv1[[]1]5+cd[[][2]][1]
*pv1[[]1]6
4
3
2
2
l[4][0]=cd[[][1]][1]
*pv2[[]1]6+cd[[][1]][1]
*cd[[][2]][1]*pv2[[]1]5+cd[[][1]][1]
*cd[[][2]][1]
*pv2[[]1]4
4
3
*pv2[[]1]2
+cd[[][1]][1]*cd[[][2]][1]
*pv2[[]1]3+cd[[][2]][1]

notethatmuchofthecomplicationintheseequationsiscausedbythearbitraryindicesassignedtothepv
coefficients.thenextstepistocomputetheinverseofthecd[[][′]][m]atrixascd[[][′]][−]1.then,thesipcoefficients
arecomputedasfollows:


ai,j
bi,j



=cd[[][′]][−]1



k[i][j]
l[i][j]



.

thereverse-sipcoefficientsarecalculatedandthepvc[[]o]efficientsarerecalculatedbyoursoftware,butthese
equationsarenotshownhere.

appendixb.samplefitsheader
forasampleptfimage(withprocessed-imageid=13051948),belowisalistingoftheportionofitsfits
headerthatisrelevanttothewcssolutionandthetworepresentationsofgeometricd[[][i]][s]tortioncontainedtherein.
see§4foradiscussionofthisexample.noticethemissingscamp-generatedpvi[[]j]keywordsthatcorrespond
totheradialtermsineqs.1and2.
/astrometry
crval1
crval2
crpix1
crpix2
ctype1
ctype2
cunit1
cunit2
crtype1
crtype2
cd[[][1]][_]1

=
=
=
=
=
=
=
=
=
=
=

104.758177886399
17.5110457095458
767.6599731
1732.279053
’ra---tan-sip’
’dec--tan-sip’
’deg
’
’deg
’
’deg
’
’deg
’
0.000281189660249318

/[deg]raofreferencepoint
/[deg]decofreferencepoint

/
/
/
/
/
/
/

tan(gnomic)projection+sipdistortions
tan(gnomic)projection+sipdistortions
imageaxis-1celestial-coordinateunits
imageaxis-2celestial-coordinateunits
dataunitsofcrval1
dataunitsofcrval2
transformationmatrix

proc.ofspievol.845184511m-10
downloadedfrom:http://proceedings.spiedigitallibrary.org/on02/22/2013termsofuse:http://spiedl.org/terms



xdiff
ydiff



=cd

′



udiff
vdiff



crval1′=crval1+xdiff/cos(crval2*π/180)
crval2′=crval2+ydiff
definetheintermediatepolynomialsk[i][j]andl[i][j]asfollows:
2
2
*pv1[[]6]
k[0][2]=cd[[][1]][2]
*pv1[[]4]+cd[[][1]][2]*cd[[][2]][2]*pv1[[]5]+cd[[][2]][2]
2
2
*pv2[[]4]
l[0][2]=cd[[][1]][2]
*pv2[[]6]+cd[[][1]][2]*cd[[][2]][2]*pv2[[]5]+cd[[][2]][2]
k[1][1]=2*cd[[][1]][1]*cd[[][1]][2]*pv1[[]4]+cd[[][1]][1]*cd[[][2]][2]*pv1[[]5]+cd[[][1]][2]*cd[[][2]][1]*pv1[[]5]
+2*cd[[][2]][1]*cd[[][2]][2]*pv1[[]6]

l[1][1]=2*cd[[][1]][1]*cd[[][1]][2]*pv2[[]6]+cd[[][1]][1]*cd[[][2]][2]*pv2[[]5]+cd[[][1]][2]*cd[[][2]][1]*pv2[[]5]
+2*cd[[][2]][1]*cd[[][2]][2]*pv2[[]4]
2
2
*pv1[[]6]
k[0][2]=cd[[][1]][2]
*pv1[[]4]+cd[[][1]][2]*cd[[][2]][2]*pv1[[]5]+cd[[][2]][2]
2
2
l[0][2]=cd[[][1]][2]
*pv2[[]6]+cd[[][1]][2]*cd[[][2]][2]*pv2[[]5]+cd[[][2]][2]
*pv2[[]4]
3
2
2
3
k[0][3]=cd[[][1]][2]
*pv1[[]7]+cd[[][1]][2]
*cd[[][2]][2]*pv1[[]8]+cd[[][1]][2]*cd[[][2]][2]
*pv1[[]9]+cd[[][2]][2]
*pv1[[]1]0
3
2
2
3
l[0][3]=cd[[][1]][2]
*pv2[[]1]0+cd[[][1]][2]
*cd[[][2]][2]*pv2[[]9]+cd[[][1]][2]*cd[[][2]][2]
*pv2[[]8]+cd[[][2]][2]
*pv2[[]7]
2
2
k[1][2]=3*cd[[][1]][1]*cd[[][1]][2]
*pv1[[]7]+2*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][2]*pv1[[]8]+cd[[][1]][1]*cd[[][2]][2]
*pv1[[]9]
2
2
*pv1[[]1]0
+cd[[][1]][2]
*cd[[][2]][1]*pv1[[]8]+2*cd[[][1]][2]*cd[[][2]][1]*cd[[][2]][2]*pv1[[]9]+3*cd[[][2]][1]*cd[[][2]][2]
2
2
l[1][2]=3*cd[[][1]][1]*cd[[][1]][2]
*pv2[[]1]0+2*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][2]*pv2[[]9]+cd[[][1]][1]*cd[[][2]][2]
*pv2[[]8]
2
2
+cd[[][1]][2]
*cd[[][2]][1]*pv2[[]9]+2*cd[[][1]][2]*cd[[][2]][1]*cd[[][2]][2]*pv2[[]8]+3*cd[[][2]][1]*cd[[][2]][2]
*pv2[[]7]
2
2
*cd[[][2]][2]*pv1[[]8]+2*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][1]*pv1[[]8]
k[2][1]=3*cd[[][1]][1]
*cd[[][1]][2]*pv1[[]7]+cd[[][1]][1]
2
2
+2*cd[[][1]][1]*cd[[][2]][1]*cd[[][2]][2]*pv1[[]9]+cd[[][1]][2]*cd[[][2]][1]
*pv1[[]9]+3*cd[[][2]][1]
*cd[[][2]][2]*pv1[[]1]0
2
2
l[2][1]=3*cd[[][1]][1]
*cd[[][1]][2]*pv2[[]1]0+cd[[][1]][1]
*cd[[][2]][2]*pv2[[]9]+2*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][1]*pv2[[]9]
2
2
+2*cd[[][1]][1]*cd[[][2]][1]*cd[[][2]][2]*pv2[[]8]+cd[[][1]][2]*cd[[][2]][1]
*pv2[[]8]+3*cd[[][2]][1]
*cd[[][2]][2]*pv2[[]7]
3
2
2
3
k[3][0]=cd[[][1]][1]
*pv1[[]7]+cd[[][1]][1]
*cd[[][2]][1]*pv1[[]8]+cd[[][1]][1]*cd[[][2]][1]
*pv1[[]9]+cd[[][2]][1]
*pv1[[]1]0
3
2
2
3
l[3][0]=cd[[][1]][1]
*pv2[[]1]0+cd[[][1]][1]
*cd[[][2]][1]*pv2[[]9]+cd[[][1]][1]*cd[[][2]][1]
*pv2[[]8]+cd[[][2]][1]
*pv2[[]7]
4
3
2
2
k[0][4]=cd[[][1]][2]
*pv1[[]1]2+cd[[][1]][2]
*cd[[][2]][2]*pv1[[]1]3+cd[[][1]][2]
*cd[[][2]][2]
*pv1[[]1]4
4
3
+cd[[][1]][2]*cd[[][2]][2]
*pv1[[]1]5+cd[[][2]][2]
*pv1[[]1]6
4
3
2
2
l[0][4]=cd[[][1]][2]
*pv2[[]1]6+cd[[][1]][2]
*cd[[][2]][2]*pv2[[]1]5+cd[[][1]][2]
*cd[[][2]][2]
*pv2[[]1]4
3
4
+cd[[][1]][2]*cd[[][2]][2]
*pv2[[]1]3+cd[[][2]][2]
*pv2[[]1]2
2
2
3
k[1][3]=4*cd[[][1]][1]*cd[[][1]][2]
*pv1[[]1]2+3*cd[[][1]][1]*cd[[][1]][2]
*cd[[][2]][2]*pv1[[]1]3+2*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][2]
*pv1[[]1]4
3
3
2
+cd[[][1]][1]*cd[[][2]][2]
*pv1[[]1]5+cd[[][1]][2]
*cd[[][2]][1]*pv1[[]1]3+2*cd[[][1]][2]
*cd[[][2]][1]*cd[[][2]][2]*pv1[[]1]4
2
3
+3*cd[[][1]][2]*cd[[][2]][1]*cd[[][2]][2]
*pv1[[]1]5+4*cd[[][2]][1]*cd[[][2]][2]
*pv1[[]1]6
3
2
2
l[1][3]=4*cd[[][1]][1]*cd[[][1]][2]
*pv2[[]1]6+3*cd[[][1]][1]*cd[[][1]][2]
*cd[[][2]][2]*pv2[[]1]5+2*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][2]
*pv2[[]1]4
3
2
3
+cd[[][1]][1]*cd[[][2]][2]
*pv2[[]1]3+cd[[][1]][2]
*cd[[][2]][1]*pv2[[]1]5+2*cd[[][1]][2]
*cd[[][2]][1]*cd[[][2]][2]*pv2[[]1]4
2
3
+3*cd[[][1]][2]*cd[[][2]][1]*cd[[][2]][2]
*pv2[[]1]3+4*cd[[][2]][1]*cd[[][2]][2]
*pv2[[]1]2
2
2
2
2
2
k[2][2]=6*cd[[][1]][1]
*cd[[][1]][2]
*pv1[[]1]2+3*cd[[][1]][1]
*cd[[][1]][2]*cd[[][2]][2]*pv1[[]1]3+cd[[][1]][1]
*cd[[][2]][2]
*pv1[[]1]4
2
+3*cd[[][1]][1]*cd[[][1]][2]
*cd[[][2]][1]*pv1[[]1]3+4*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][1]*cd[[][2]][2]*pv1[[]1]4

proc.ofspievol.845184511m-9
downloadedfrom:http://proceedings.spiedigitallibrary.org/on02/22/2013termsofuse:http://spiedl.org/terms

2
2
2
+3*cd[[][1]][1]*cd[[][2]][1]*cd[[][2]][2]
*pv1[[]1]5+cd[[][1]][2]
*cd[[][2]][1]
*pv1[[]1]4
2
2
2
+3*cd[[][1]][2]*cd[[][2]][1]
*cd[[][2]][2]*pv1[[]1]5+6*cd[[][2]][1]
*cd[[][2]][2]
*pv1[[]1]6
2
2
2
2
2
*cd[[][1]][2]*cd[[][2]][2]*pv2[[]1]5+cd[[][1]][1]
*cd[[][2]][2]
*pv2[[]1]4
l[2][2]=6*cd[[][1]][1]
*cd[[][1]][2]
*pv2[[]1]6+3*cd[[][1]][1]
2
+3*cd[[][1]][1]*cd[[][1]][2]
*cd[[][2]][1]*pv2[[]1]5+4*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][1]*cd[[][2]][2]*pv2[[]1]4+
2
2
2
3*cd[[][1]][1]*cd[[][2]][1]*cd[[][2]][2]
*pv2[[]1]3+cd[[][1]][2]
*cd[[][2]][1]
*pv2[[]1]4
2
2
2
+3*cd[[][1]][2]*cd[[][2]][1]
*cd[[][2]][2]*pv2[[]1]3+6*cd[[][2]][1]
*cd[[][2]][2]
*pv2[[]1]2
3
3
2
k[3][1]=4*cd[[][1]][1]
*cd[[][1]][2]*pv1[[]1]2+cd[[][1]][1]
*cd[[][2]][2]*pv1[[]1]3+3*cd[[][1]][1]
*cd[[][1]][2]*cd[[][2]][1]*pv1[[]1]3
2
2
*pv1[[]1]4
+2*cd[[][1]][1]
*cd[[][2]][1]*cd[[][2]][2]*pv1[[]1]4+2*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][1]
2
3
3
+3*cd[[][1]][1]*cd[[][2]][1]
*cd[[][2]][2]*pv1[[]1]5+cd[[][1]][2]*cd[[][2]][1]
*pv1[[]1]5+4*cd[[][2]][1]
*cd[[][2]][2]*pv1[[]1]6
3
3
2
l[3][1]=4*cd[[][1]][1]
*cd[[][1]][2]*pv2[[]1]6+cd[[][1]][1]
*cd[[][2]][2]*pv2[[]1]5+3*cd[[][1]][1]
*cd[[][1]][2]*cd[[][2]][1]*pv2[[]1]5
2
2
*pv2[[]1]4
+2*cd[[][1]][1]
*cd[[][2]][1]*cd[[][2]][2]*pv2[[]1]4+2*cd[[][1]][1]*cd[[][1]][2]*cd[[][2]][1]
2
3
3
+3*cd[[][1]][1]*cd[[][2]][1]
*cd[[][2]][2]*pv2[[]1]3+cd[[][1]][2]*cd[[][2]][1]
*pv2[[]1]3+4*cd[[][2]][1]
*cd[[][2]][2]*pv2[[]1]2
3
2
2
4
*cd[[][2]][1]*pv1[[]1]3+cd[[][1]][1]
*cd[[][2]][1]
*pv1[[]1]4
k[4][0]=cd[[][1]][1]
*pv1[[]1]2+cd[[][1]][1]
3
4
+cd[[][1]][1]*cd[[][2]][1]
*pv1[[]1]5+cd[[][2]][1]
*pv1[[]1]6
4
3
2
2
l[4][0]=cd[[][1]][1]
*pv2[[]1]6+cd[[][1]][1]
*cd[[][2]][1]*pv2[[]1]5+cd[[][1]][1]
*cd[[][2]][1]
*pv2[[]1]4
4
3
*pv2[[]1]2
+cd[[][1]][1]*cd[[][2]][1]
*pv2[[]1]3+cd[[][2]][1]

notethatmuchofthecomplicationintheseequationsiscausedbythearbitraryindicesassignedtothepv
coefficients.thenextstepistocomputetheinverseofthecd[[][′]][m]atrixascd[[][′]][−]1.then,thesipcoefficients
arecomputedasfollows:


ai,j
bi,j



=cd[[][′]][−]1



k[i][j]
l[i][j]



.

thereverse-sipcoefficientsarecalculatedandthepvc[[]o]efficientsarerecalculatedbyoursoftware,butthese
equationsarenotshownhere.

appendixb.samplefitsheader
forasampleptfimage(withprocessed-imageid=13051948),belowisalistingoftheportionofitsfits
headerthatisrelevanttothewcssolutionandthetworepresentationsofgeometricd[[][i]][s]tortioncontainedtherein.
see§4foradiscussionofthisexample.noticethemissingscamp-generatedpvi[[]j]keywordsthatcorrespond
totheradialtermsineqs.1and2.
/astrometry
crval1
crval2
crpix1
crpix2
ctype1
ctype2
cunit1
cunit2
crtype1
crtype2
cd[[][1]][_]1

=
=
=
=
=
=
=
=
=
=
=

104.758177886399
17.5110457095458
767.6599731
1732.279053
’ra---tan-sip’
’dec--tan-sip’
’deg
’
’deg
’
’deg
’
’deg
’
0.000281189660249318

/[deg]raofreferencepoint
/[deg]decofreferencepoint

/
/
/
/
/
/
/

tan(gnomic)projection+sipdistortions
tan(gnomic)projection+sipdistortions
imageaxis-1celestial-coordinateunits
imageaxis-2celestial-coordinateunits
dataunitsofcrval1
dataunitsofcrval2
transformationmatrix

proc.ofspievol.845184511m-10
downloadedfrom:http://proceedings.spiedigitallibrary.org/on02/22/2013termsofuse:http://spiedl.org/terms



xdiff
ydiff



=cd

′



udiff
vdiff



crval1′=crval1+xdiff/cos(crval2*π/180)
crval2′=crval2+ydiff
definetheintermediatepolynomialsk[i][j]andl[i][j]asfollows:
2
2
*pv1[[][]6]
k[0][2]=cd[[][[]][1]][2]
*pv1[[][]4]+cd[[][[]][1]][2]*cd[[][[]][2]][2]*pv1[[][]5]+cd[[][[]][2]][2]
2
2
*pv2[[][]4]
l[0][2]=cd[[][[]][1]][2]
*pv2[[][]6]+cd[[][[]][1]][2]*cd[[][[]][2]][2]*pv2[[][]5]+cd[[][[]][2]][2]
k[1][1]=2*cd[[][[]][1]][1]*cd[[][[]][1]][2]*pv1[[][]4]+cd[[][[]][1]][1]*cd[[][[]][2]][2]*pv1[[][]5]+cd[[][[]][1]][2]*cd[[][[]][2]][1]*pv1[[][]5]
+2*cd[[][[]][2]][1]*cd[[][[]][2]][2]*pv1[[][]6]

l[1][1]=2*cd[[][[]][1]][1]*cd[[][[]][1]][2]*pv2[[][]6]+cd[[][[]][1]][1]*cd[[][[]][2]][2]*pv2[[][]5]+cd[[][[]][1]][2]*cd[[][[]][2]][1]*pv2[[][]5]
+2*cd[[][[]][2]][1]*cd[[][[]][2]][2]*pv2[[][]4]
2
2
*pv1[[][]6]
k[0][2]=cd[[][[]][1]][2]
*pv1[[][]4]+cd[[][[]][1]][2]*cd[[][[]][2]][2]*pv1[[][]5]+cd[[][[]][2]][2]
2
2
l[0][2]=cd[[][[]][1]][2]
*pv2[[][]6]+cd[[][[]][1]][2]*cd[[][[]][2]][2]*pv2[[][]5]+cd[[][[]][2]][2]
*pv2[[][]4]
3
2
2
3
k[0][3]=cd[[][[]][1]][2]
*pv1[[][]7]+cd[[][[]][1]][2]
*cd[[][[]][2]][2]*pv1[[][]8]+cd[[][[]][1]][2]*cd[[][[]][2]][2]
*pv1[[][]9]+cd[[][[]][2]][2]
*pv1[[][]1]0
3
2
2
3
l[0][3]=cd[[][[]][1]][2]
*pv2[[][]1]0+cd[[][[]][1]][2]
*cd[[][[]][2]][2]*pv2[[][]9]+cd[[][[]][1]][2]*cd[[][[]][2]][2]
*pv2[[][]8]+cd[[][[]][2]][2]
*pv2[[][]7]
2
2
k[1][2]=3*cd[[][[]][1]][1]*cd[[][[]][1]][2]
*pv1[[][]7]+2*cd[[][[]][1]][1]*cd[[][[]][1]][2]*cd[[][[]][2]][2]*pv1[[][]8]+cd[[][[]][1]][1]*cd[[][[]][2]][2]
*pv1[[][]9]
2
2
*pv1[[][]1]0
+cd[[][[]][1]][2]
*cd[[][[]][2]][1]*pv1[[][]8]+2*cd[[][[]][1]][2]*cd[[][[]][2]][1]*cd[[][[]][2]][2]*pv1[[][]9]+3*cd[[][[]][2]][1]*cd[[][[]][2]][2]
2
2
l[1][2]=3*cd[[][[]][1]][1]*cd[[][[]][1]][2]
*pv2[[][]1]0+2*cd[[][[]][1]][1]*cd[[][[]][1]][2]*cd[[][[]][2]][2]*pv2[[][]9]+cd[[][[]][1]][1]*cd[[][[]][2]][2]
*pv2[[][]8]
2
2
+cd[[][[]][1]][2]
*cd[[][[]][2]][1]*pv2[[][]9]+2*cd[[][[]][1]][2]*cd[[][[]][2]][1]*cd[[][[]][2]][2]*pv2[[][]8]+3*cd[[][[]][2]][1]*cd[[][[]][2]][2]
*pv2[[][]7]
2
2
*cd[[][[]][2]][2]*pv1[[][]8]+2*cd[[][[]][1]][1]*cd[[][[]][1]][2]*cd[[][[]][2]][1]*pv1[[][]8]
k[2][1]=3*cd[[][[]][1]][1]
*cd[[][[]][1]][2]*pv1[[][]7]+cd[[][[]][1]][1]
2
2
+2*cd[[][[]][1]][1]*cd[[][[]][2]][1]*cd[[][[]][2]][2]*pv1[[][]9]+cd[[][[]][1]][2]*cd[[][[]][2]][1]
*pv1[[][]9]+3*cd[[][[]][2]][1]
*cd[[][[]][2]][2]*pv1[[][]1]0
2
2
l[2][1]=3*cd[[][[]][1]][1]
*cd[[][[]][1]][2]*pv2[[][]1]0+cd[[][[]][1]][1]
*cd[[][[]][2]][2]*pv2[[][]9]+2*cd[[][[]][1]][1]*cd[[][[]][1]][2]*cd[[][[]][2]][1]*pv2[[][]9]
2
2
+2*cd[[][[]][1]][1]*cd[[][[]][2]][1]*cd[[][[]][2]][2]*pv2[[][]8]+cd[[][[]][1]][2]*cd[[][[]][2]][1]
*pv2[[][]8]+3*cd[[][[]][2]][1]
*cd[[][[]][2]][2]*pv2[[][]7]
3
2
2
3
k[3][0]=cd[[][[]][1]][1]
*pv1[[][]7]+cd[[][[]][1]][1]
*cd[[][[]][2]][1]*pv1[[][]8]+cd[[][[]][1]][1]*cd[[][[]][2]][1]
*pv1[[][]9]+cd[[][[]][2]][1]
*pv1[[][]1]0
3
2
2
3
l[3][0]=cd[[][[]][1]][1]
*pv2[[][]1]0+cd[[][[]][1]][1]
*cd[[][[]][2]][1]*pv2[[][]9]+cd[[][[]][1]][1]*cd[[][[]][2]][1]
*pv2[[][]8]+cd[[][[]][2]][1]
*pv2[[][]7]
4
3
2
2
k[0][4]=cd[[][[]][1]][2]
*pv1[[][]1]2+cd[[][[]][1]][2]
*cd[[][[]][2]][2]*pv1[[][]1]3+cd[[][[]][1]][2]
*cd[[][[]][2]][2]
*pv1[[][]1]4
4
3
+cd[[][[]][1]][2]*cd[[][[]][2]][2]
*pv1[[][]1]5+cd[[][[]][2]][2]
*pv1[[][]1]6
4
3
2
2
l[0][4]=cd[[][[]][1]][2]
*pv2[[][]1]6+cd[[][[]][1]][2]
*cd[[][[]][2]][2]*pv2[[][]1]5+cd[[][[]][1]][2]
*cd[[][[]][2]][2]
*pv2[[][]1]4
3
4
+cd[[][[]][1]][2]*cd[[][[]][2]][2]
*pv2[[][]1]3+cd[[][[]][2]][2]
*pv2[[][]1]2
2
2
3
k[1][3]=4*cd[[][[]][1]][1]*cd[[][[]][1]][2]
*pv1[[][]1]2+3*cd[[][[]][1]][1]*cd[[][[]][1]][2]
*cd[[][[]][2]][2]*pv1[[][]1]3+2*cd[[][[]][1]][1]*cd[[][[]][1]][2]*cd[[][[]][2]][2]
*pv1[[][]1]4
3
3
2
+cd[[][[]][1]][1]*cd[[][[]][2]][2]
*pv1[[][]1]5+cd[[][[]][1]][2]
*cd[[][[]][2]][1]*pv1[[][]1]3+2*cd[[][[]][1]][2]
*cd[[][[]][2]][1]*cd[[][[]][2]][2]*pv1[[][]1]4
2
3
+3*cd[[][[]][1]][2]*cd[[][[]][2]][1]*cd[[][[]][2]][2]
*pv1[[][]1]5+4*cd[[][[]][2]][1]*cd[[][[]][2]][2]
*pv1[[][]1]6
3
2
2
l[1][3]=4*cd[[][[]][1]][1]*cd[[][[]][1]][2]
*pv2[[][]1]6+3*cd[[][[]][1]][1]*cd[[][[]][1]][2]
*cd[[][[]][2]][2]*pv2[[][]1]5+2*cd[[][[]][1]][1]*cd[[][[]][1]][2]*cd[[][[]][2]][2]
*pv2[[][]1]4
3
2
3
+cd[[][[]][1]][1]*cd[[][[]][2]][2]
*pv2[[][]1]3+cd[[][[]][1]][2]
*cd[[][[]][2]][1]*pv2[[][]1]5+2*cd[[][[]][1]][2]
*cd[[][[]][2]][1]*cd[[][[]][2]][2]*pv2[[][]1]4
2
3
+3*cd[[][[]][1]][2]*cd[[][[]][2]][1]*cd[[][[]][2]][2]
*pv2[[][]1]3+4*cd[[][[]][2]][1]*cd[[][[]][2]][2]
*pv2[[][]1]2
2
2
2
2
2
k[2][2]=6*cd[[][[]][1]][1]
*cd[[][[]][1]][2]
*pv1[[][]1]2+3*cd[[][[]][1]][1]
*cd[[][[]][1]][2]*cd[[][[]][2]][2]*pv1[[][]1]3+cd[[][[]][1]][1]
*cd[[][[]][2]][2]
*pv1[[][]1]4
2
+3*cd[[][[]][1]][1]*cd[[][[]][1]][2]
*cd[[][[]][2]][1]*pv1[[][]1]3+4*cd[[][[]][1]][1]*cd[[][[]][1]][2]*cd[[][[]][2]][1]*cd[[][[]][2]][2]*pv1[[][]1]4

proc.ofspievol.845184511m-9
downloadedfrom:http://proceedings.spiedigitallibrary.org/on02/22/2013termsofuse:http://spiedl.org/terms

2
2
2
+3*cd[[][[]][1]][1]*cd[[][[]][2]][1]*cd[[][[]][2]][2]
*pv1[[][]1]5+cd[[][[]][1]][2]
*cd[[][[]][2]][1]
*pv1[[][]1]4
2
2
2
+3*cd[[][[]][1]][2]*cd[[][[]][2]][1]
*cd[[][[]][2]][2]*pv1[[][]1]5+6*cd[[][[]][2]][1]
*cd[[][[]][2]][2]
*pv1[[][]1]6
2
2
2
2
2
*cd[[][[]][1]][2]*cd[[][[]][2]][2]*pv2[[][]1]5+cd[[][[]][1]][1]
*cd[[][[]][2]][2]
*pv2[[][]1]4
l[2][2]=6*cd[[][[]][1]][1]
*cd[[][[]][1]][2]
*pv2[[][]1]6+3*cd[[][[]][1]][1]
2
+3*cd[[][[]][1]][1]*cd[[][[]][1]][2]
*cd[[][[]][2]][1]*pv2[[][]1]5+4*cd[[][[]][1]][1]*cd[[][[]][1]][2]*cd[[][[]][2]][1]*cd[[][[]][2]][2]*pv2[[][]1]4+
2
2
2
3*cd[[][[]][1]][1]*cd[[][[]][2]][1]*cd[[][[]][2]][2]
*pv2[[][]1]3+cd[[][[]][1]][2]
*cd[[][[]][2]][1]
*pv2[[][]1]4
2
2
2
+3*cd[[][[]][1]][2]*cd[[][[]][2]][1]
*cd[[][[]][2]][2]*pv2[[][]1]3+6*cd[[][[]][2]][1]
*cd[[][[]][2]][2]
*pv2[[][]1]2
3
3
2
k[3][1]=4*cd[[][[]][1]][1]
*cd[[][[]][1]][2]*pv1[[][]1]2+cd[[][[]][1]][1]
*cd[[][[]][2]][2]*pv1[[][]1]3+3*cd[[][[]][1]][1]
*cd[[][[]][1]][2]*cd[[][[]][2]][1]*pv1[[][]1]3
2
2
*pv1[[][]1]4
+2*cd[[][[]][1]][1]
*cd[[][[]][2]][1]*cd[[][[]][2]][2]*pv1[[][]1]4+2*cd[[][[]][1]][1]*cd[[][[]][1]][2]*cd[[][[]][2]][1]
2
3
3
+3*cd[[][[]][1]][1]*cd[[][[]][2]][1]
*cd[[][[]][2]][2]*pv1[[][]1]5+cd[[][[]][1]][2]*cd[[][[]][2]][1]
*pv1[[][]1]5+4*cd[[][[]][2]][1]
*cd[[][[]][2]][2]*pv1[[][]1]6
3
3
2
l[3][1]=4*cd[[][[]][1]][1]
*cd[[][[]][1]][2]*pv2[[][]1]6+cd[[][[]][1]][1]
*cd[[][[]][2]][2]*pv2[[][]1]5+3*cd[[][[]][1]][1]
*cd[[][[]][1]][2]*cd[[][[]][2]][1]*pv2[[][]1]5
2
2
*pv2[[][]1]4
+2*cd[[][[]][1]][1]
*cd[[][[]][2]][1]*cd[[][[]][2]][2]*pv2[[][]1]4+2*cd[[][[]][1]][1]*cd[[][[]][1]][2]*cd[[][[]][2]][1]
2
3
3
+3*cd[[][[]][1]][1]*cd[[][[]][2]][1]
*cd[[][[]][2]][2]*pv2[[][]1]3+cd[[][[]][1]][2]*cd[[][[]][2]][1]
*pv2[[][]1]3+4*cd[[][[]][2]][1]
*cd[[][[]][2]][2]*pv2[[][]1]2
3
2
2
4
*cd[[][[]][2]][1]*pv1[[][]1]3+cd[[][[]][1]][1]
*cd[[][[]][2]][1]
*pv1[[][]1]4
k[4][0]=cd[[][[]][1]][1]
*pv1[[][]1]2+cd[[][[]][1]][1]
3
4
+cd[[][[]][1]][1]*cd[[][[]][2]][1]
*pv1[[][]1]5+cd[[][[]][2]][1]
*pv1[[][]1]6
4
3
2
2
l[4][0]=cd[[][[]][1]][1]
*pv2[[][]1]6+cd[[][[]][1]][1]
*cd[[][[]][2]][1]*pv2[[][]1]5+cd[[][[]][1]][1]
*cd[[][[]][2]][1]
*pv2[[][]1]4
4
3
*pv2[[][]1]2
+cd[[][[]][1]][1]*cd[[][[]][2]][1]
*pv2[[][]1]3+cd[[][[]][2]][1]

notethatmuchofthecomplicationintheseequationsiscausedbythearbitraryindicesassignedtothepv
coefficients.thenextstepistocomputetheinverseofthecd[[][[]][′]][m]atrixascd[[][[]][′]][−]1.then,thesipcoefficients
arecomputedasfollows:


ai,j
bi,j



=cd[[][[]][′]][−]1



k[i][j]
l[i][j]



.

thereverse-sipcoefficientsarecalculatedandthepvc[[][]o]efficientsarerecalculatedbyoursoftware,butthese
equationsarenotshownhere.

appendixb.samplefitsheader
forasampleptfimage(withprocessed-imageid=13051948),belowisalistingoftheportionofitsfits
headerthatisrelevanttothewcssolutionandthetworepresentationsofgeometricd[[][[]][i]][s]tortioncontainedtherein.
see§4foradiscussionofthisexample.noticethemissingscamp-generatedpvi[[][]j]keywordsthatcorrespond
totheradialtermsineqs.1and2.
/astrometry
crval1
crval2
crpix1
crpix2
ctype1
ctype2
cunit1
cunit2
crtype1
crtype2
cd[[][[]][1]][_]1

=
=
=
=
=
=
=
=
=
=
=

104.758177886399
17.5110457095458
767.6599731
1732.279053
’ra---tan-sip’
’dec--tan-sip’
’deg
’
’deg
’
’deg
’
’deg
’
0.000281189660249318

/[deg]raofreferencepoint
/[deg]decofreferencepoint

/
/
/
/
/
/
/

tan(gnomic)projection+sipdistortions
tan(gnomic)projection+sipdistortions
imageaxis-1celestial-coordinateunits
imageaxis-2celestial-coordinateunits
dataunitsofcrval1
dataunitsofcrval2
transformationmatrix

proc.ofspievol.845184511m-10
downloadedfrom:http://proceedings.spiedigitallibrary.org/on02/22/2013termsofuse:http://spiedl.org/terms

